# Выявление подходящей технологии для параллельных вычислений над массивами чисел с плавающей точкой на графическом процессоре.
Ключевые слова: параллельное программирование, GPGPU, вычисления на графическом процессоре, скорость выполнения вычислений.

## Аннотация
В данной работе были рассмотрены технологии для параллельных вычислений на GPU для работы с массивами с плавающей точкой. В качестве критериев сравнения были выбраны совместимость с оборудованием, производительность и обучаемость. В процессе анализа выяснилось, что наиболее подходящим решением является использование технологии CUDA. 

## Введение
Ввиду распространения практики использования беспилотных летательных аппаратов[1] для фото- и видеосъемки становится актуальной проблема обнаружения их присутствия в воздушном пространстве для дальнейшего предотвращения возможных незаконных действий. Так как на сегодняшний день существует большое количество моделей БПЛА, работающих на разных частотах, актуальной задачей радиомониторинга становится обнаружение БПЛА в широком спектре частот. Из-за возрастания требуемого количества отслеживаемых частот, обнаружение местонахождения БПЛА с использованием многопоточных вычислений на центральных процессорах становится времязатратным. Перенос вычислений с центрального процессора на графический процессор позволит быстрее обрабатывать поступающие данные [2], что позволит увеличить скорость отслеживания летательных аппаратов.

Объектом исследования являются технологии, позволяющие производить параллельные вычисления над массивами, содержащими значения с плавающей точкой на графическом процессоре. Предметом исследования выступает скорость выполнения параллельных вычислений над массивами чисел с плавающей точкой на графическом процессоре. Цель состоит в выявлении подходящей технологии для параллельных вычислений над массивами чисел с плавающей точкой на графическом процессоре. Для достижения цели поставлены следующие задачи:  
1. Обзор существующих технологий для реализации параллельных вычислений над массивами чисел с плавающей точкой на графическом процессоре.
2. Определение критериев для оценки степени соответствия технологии нуждам радиомониторинга.
3. Сравнение выбранных технологий по сформированным критериям.
4. Выбор наиболее подходящей технологии.

Реализация перечисленных задач позволит выбрать подходящую технологию для реализации более быстрой обработки данных, что приведет к ускорению отслеживания летательных аппаратов.

## Обзор предметной области

В роли сравнительных аналогов были рассмотрены технологии для реализации параллельных вычислений на графическом процессоре. Основным критерием служила возможность работы с массивами, состоящими из чисел с плавающей точкой. Подбор аналогов осуществлялся с использованием ресурса Google Scholar. Для поиска применялся следующий запрос: "параллельное программирование GPU". По данному запросу был получен следующий список аналогов: 
- **OpenCL [3, 4, 5, 6]** — это открытый стандарт, предназначенный для создания программ, которые могут выполняться на центральных и графических процессорах. OpenCL позволяет проводить вычисления на графических и центральных процессорах с помощью API, реализованного на адаптированной версии C — OpenCL C. OpenCL обеспечивает платформонезависимость и позволяет использовать одно и то же приложение на оборудовании разных производителей, таких как AMD, Intel и NVIDIA
- **CUDA [6, 7]** — это проприетарная платформа и набор инструментов, разработанный компанией NVIDIA для вычислений на их графических процессорах. CUDA предоставляет упрощенные API и инструменты для ускорения разработки параллельных приложений. Основным ограничением является привязанность к оборудованию NVIDIA.  
- **ROCm [8]** — это программная платформа с открытым исходным кодом, предназначенная для вычислений на графических процессорах и ориентированная в первую очередь на высокопроизводительные вычисления (HPC), машинное обучение и другие приложения с интенсивными вычислениями. Он предоставляет разработчикам основу для написания портативных и высокопроизводительных приложений для графических процессоров AMD.
- **Vulkan [9]** — это высокопроизводительный низкоуровневый API, предназначенный в первую очередь для графических и вычислительных задач. Он обеспечивает явный контроль над ресурсами и операциями графического процессора, обеспечивая расширенную оптимизацию. Вычислительные возможности Vulkan позволяют разработчикам выполнять вычисления на графическом процессоре общего назначения (GPGPU). API очень гибок и поддерживает ряд платформ, таких как Windows, Linux, macOS, Android, а также различных поставщиков графических процессоров, включая NVIDIA, AMD и Intel.
- **DirectCompute [10, 11]** является частью API Microsoft DirectX и специально разработан для выполнения вычислительных операций на графических процессорах. Он интегрирован с другими компонентами DirectX, что делает его особенно полезным для приложений, предназначенных для Windows. Хотя DirectCompute обеспечивает мощные вычисления с ускорением на графическом процессоре, его основное внимание уделяется платформам на базе Windows.
 
Несмотря на то, что представленные в списке аналогов технологии находятся на разных уровнях абстракции (OpenCL — стандарт, CUDA и ROCm — платформы, Vulkan и DirectCompute — API), все они предоставляют доступ к необходимому для задач радиомониторинга низкоуровоневому API, позволяющему выполнять задачи общего назначенния на графических процессорах (GPGPU), в том числе вычисления над массивами, содержащими числа с плавающей точкой.

Таким образом, все рассмотренные технологии предоставляют возможность проводить параллельные вычисления над массивами, состоящими из чисел с плавающей точкой, однако скорость выполнения операций у технологий разная. Анализ технологий позволил выделить главные критерии, по которым будет выбрана наиболее подходящая технология:

- **Совместимость с оборудованием** — данный критерий оценивает количество устройств, поддерживающих работу с технологией. Чем их больше, тем выше оценка.
-  **Производительность** — в данном критерии оценивается скорость выполнения вычислений технологией. Тестирование производилось на одинаковом оборудовании в виде перемножения ста пар матриц чисел с плавающей точкой размера 2000x2000[12]. Чем меньше время выполнения, тем выше оценка.
- **Обучаемость** — данный критерий отражает уровень сложности в освоении технологии. Этот критерий включает в себя доступность обучающих материалов, примеров кода и общую сложность освоения.

Для удобства результаты анализа сведены в таблицу 1 (см. табл. 1).

**Таблица 1 – Сравнение интеграционных решений по ключевым критериям**

|Аналог|Совместимость с оборудованием         |Производительность|Обучаемость 
|------|--------------------------------------|------------------|-----------
|OpenCL| Устройства от Nvidia, AMD, Intel, ARM|0.2-1 секунд     |Низкоуровневое API,требующее знание платформ и драйверов; ограниченное количество документации и учебных материалов; множество примеров кода, но они часто требуют адаптации для разных платформ
| CUDA | Только GPU от Nvidia             |0.1-0.5 секунд     |Высокоуровневое API, подходящее для новичков; большое количество документации и курсов от самой Nvidia; множество примеров кода, не требующей адаптации под конкретное устройство. 
| ROCm |     Устройства от Nvidia, AMD        |0.1-0.5 секунд     |Высокоуровневое API, подходящее для новичков, особенно для разработчиков, знакомых с CUDA; малое количество примеров кода и обучающих материалов. 
| Vulkan | Устройства от Nvidia, AMD, Intel, ARM             |0.3-0.5 секунд     |Сложное низкоуровневое API; малое количество примеров кода и обучающих материалов 
| DirectCompute | Только Windows в связке с графическими процессорами, поддерживающими DirectX(Nvidia, AMD)            |0.5-1 секунд     |API с меньшим порогом вхождения для разработчиков, знакомых с DirectX; малое количество обучающих материалов и примеров кода.
          
В результате сравнения технологий можно сказать, что универсального решения не существует, все технологии имеют преимущества и недостатки. 

- OpenCL сложен в освоении, но дает возможность реализовывать код на CPU и GPU от различных производителей, однако, реализация на устройстве конкретного производителя может потребовать специфической оптимизации. Имеет большой разброс по скорости выполнения в виду необходимости дополнительной оптимизации под конкретное устройство.
- CUDA более проста в освоении, но не имеет вариативности в выборе платформы, однако это дает и преимущество в виде отсутствия необходимости дополнительной адаптации и оптимизации кода под конкретное устройство. Имеет один из самых высоких показателей по скорости выполнения.
- ROCm более простой в освоении, но ограничен платформами от Nvidia и AMD. Имеет один из самых высоких показателей по скорости выполнения.
- Vulkan сложен в освоении, но дает возможность реализовывать код на CPU и GPU от различных производителей, однако, реализация на устройстве конкретного производителя может потребовать специфической оптимизации. Также технология позволяет работать с устройством на низком уровне, что поможет при процессе оптимизации. Имеет средний показатель по скорости выполнения.
- DirectCompute более простой в освоении, но при условии, что разработчик уже знаком с DirectX. Технология также накладывает сильные ограничения из-за своей привязки к операционной системе Windows. Имеет средние показатели по скорости выполнения.

## Выбор метода решения

Для текущей задачи проведения параллельных вычислений над массивами, содержащими числа с плавающей точкой, была выбрана технология CUDA. Она обладает более низким порогом вхождения и превосходит аналоги по скорости вычислений на графических процессорах Nvidia, что ускорит выполнение программы, а так же избавит от необходимости реализации специфической оптимизации, так как она будет выполнятся на системе с графическим процессором от Nvidia. Решение должно представлять программный код, реализующий параллельную обработку массивов чисел с плавающей точкой, полученных от антенны-приемника, на графическом процессоре. Данный код должен быть разработан при помощи CUDA.


## Заключение
В статье был проведен обзор технологий для параллельных вычислений на GPU над массивами чисел с плавающей точкой. Далее были выбраны критерии, по которым можно выявить наиболее подходящую технологию. По выбранным критериям было проведено сравнение технологий OpneCL, CUDA, ROCm, Vulkan и DirectCompute, в результате которого было выявлено, что наиболее подходящим вариантом для реализации параллельных вычислений на GPU над массивами чисел с плавающей точкой для радиомониторинга является CUDA, так как данная технология показала самую высокую производительность и имеет обширный перечень обучающих материалов.

Направление дальнейших исследований включает:
1. Включения других аналогов для проведения параллельных вычислений на графическом процессоре.
2. Добавление новых критериев сравнения для более глубокого изучения свойств технологий для параллельных вычислений на графическом процессоре.

## Список использованных источников
1. Бондарев А. Н., Киричек Р. В. Обзор беспилотных летательных аппаратов общего пользования и регулирования воздушного движения БПЛА в разных странах Информационные технологии и телекоммуникации. 2016. Том 4. № 4. С. 13–23.
2. Агибалов О. И., Золотарёв А. А. Современные графические процессоры как средства оптимизации параллельных вычислений  Наукоемкие технологии в космических исследованиях Земли. 2014. №4. URL: https://cyberleninka.ru/article/n/sovremennye-graficheskie-protsessory-kak-sredstva-optimizatsii-parallelnyh-vychisleniy (дата обращения: 13.11.2024).
3. Gaster, B., Howes, L., Kaeli, D., Mistry, P., & Schaa, D. (2011). Heterogeneous Computing with OpenCL: Revised OpenCL 1.2 Edition. Elsevier.
4. Stone, J. E., Gohara, D., & Shi, G. (2010). OpenCL: A parallel programming standard for heterogeneous computing systems. Computing in Science & Engineering
5. Tsuchiyama, R., Nakamura, T., Iizuka, T., and Asahara, A., The OpenCL Programming Book, Fixstars Corporation, 2010.
6. [CUDA Toolkit Documentation](https://docs.nvidia.com/cuda/) 
7. Fang, J., Varbanescu, A. L., & Sips, H. (2011). A comprehensive performance comparison of CUDA and OpenCL. Proceedings of the 2011 International Conference on Parallel Processing (ICPP), 216–225. DOI: 10.1109/ICPP.2011.45. 
8. [ROCm](https://www.amd.com/en/products/software/rocm.html)
9. [Vulkan](https://community.khronos.org/c/vulkan/24)
10. Розенбаум Александр Евгеньевич, Глазков Андрей Валерьевич Современные возможности организации высокопроизводительных вычислений с использованием персональных ЭВМ // Вестник ЮУрГУ. Серия: Компьютерные технологии, управление, радиоэлектроника. 2012. №3 (262). URL: https://cyberleninka.ru/article/n/sovremennye-vozmozhnosti-organizatsii-vysokoproizvoditelnyh-vychisleniy-s-ispolzovaniem personalnyh-evm (дата обращения: 04.12.2024).
11. [DirectCompute](https://learn.microsoft.com/ru-ru/windows/win32/direct3d11/direct3d-11-advanced-stages-compute-shader) 
12. Bassam Shaer, Timothy Stewart 2023 Optimize Matrix Multiplication Utilizing OpenCL FPGA Kernel
